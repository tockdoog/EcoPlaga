<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Recomendaciones - EcoPlaga</title>
    <link rel="stylesheet" href="/static/css/recomendaciones.css">
</head>
<body>

    <!-- Sidebar -->
    <aside class="sidebar">
        <div class="logo">
            <span class="eco-icon">ğŸŒ±</span>
            <h2>EcoPlaga</h2>
        </div>
        
        <nav class="menu">
            <a href="/dashboard" class="menu-item">
                <span class="icon">ğŸ“Š</span>
                <span>Dashboard</span>
            </a>
            <a href="/cultivos" class="menu-item">
                <span class="icon">ğŸŒ¾</span>
                <span>Cultivos</span>
            </a>
            <a href="/plagas" class="menu-item">
                <span class="icon">ğŸ›</span>
                <span>Plagas</span>
            </a>
            <a href="/incidencias" class="menu-item">
                <span class="icon">âš ï¸</span>
                <span>Incidencias</span>
            </a>
            <a href="/recomendaciones" class="menu-item active">
                <span class="icon">ğŸ’¡</span>
                <span>Recomendaciones</span>
            </a>
            <a href="/tratamientos" class="menu-item">
                <span class="icon">ğŸ’Š</span>
                <span>Tratamientos</span>
            </a>
        </nav>

        <div class="sidebar-footer">
            <button class="logout-btn" onclick="logout()">
                <span class="icon">ğŸšª</span>
                <span>Cerrar SesiÃ³n</span>
            </button>
        </div>
    </aside>

    <!-- Main Content -->
    <main class="main-content">
        <div class="header">
            <div>
                <h1>ğŸ’¡ AnÃ¡lisis y Recomendaciones</h1>
            </div>
            <button class="refresh-btn" onclick="reloadData()">
                <span>ğŸ”„</span>
                Actualizar
            </button>
        </div>

        <!-- Loading State -->
        <div id="loadingState" class="loading-container">
            <div class="spinner"></div>
            <p>Analizando datos con Pandas y Numpy...</p>
        </div>

        <!-- Alertas Section -->
        <section id="alertasSection" class="section" style="display: none;">
            <h2 class="section-title">ğŸš¨ Alertas Activas</h2>
            <div id="alertasContainer" class="alerts-grid">
                <!-- Alertas dinÃ¡micas -->
            </div>
        </section>

        <!-- EstadÃ­sticas Section -->
        <section id="estadisticasSection" class="section" style="display: none;">
            <h2 class="section-title">ğŸ“Š EstadÃ­sticas Generales</h2>
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-icon">ğŸ“ˆ</div>
                    <div class="stat-info">
                        <h3 id="totalIncidencias">0</h3>
                        <p>Total Incidencias</p>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">ğŸ›</div>
                    <div class="stat-info">
                        <h3 id="plagasUnicas">0</h3>
                        <p>Plagas Ãšnicas</p>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">ğŸŒ¾</div>
                    <div class="stat-info">
                        <h3 id="cultivosAfectados">0</h3>
                        <p>Cultivos Afectados</p>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">âš¡</div>
                    <div class="stat-info">
                        <h3 id="severidadPromedio">0</h3>
                        <p>Severidad Promedio</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- Recomendaciones Section -->
        <section id="recomendacionesSection" class="section" style="display: none;">
            <h2 class="section-title">ğŸ’Š Recomendaciones de Tratamiento</h2>
            <div id="recomendacionesContainer" class="recomendaciones-grid">
                <!-- Recomendaciones dinÃ¡micas -->
            </div>
        </section>

        <!-- AnÃ¡lisis de Plagas Section -->
        <section id="analisisSection" class="section" style="display: none;">
            <h2 class="section-title">ğŸ”¬ AnÃ¡lisis Detallado por Plaga</h2>
            <div id="analisisContainer" class="analisis-container">
                <!-- AnÃ¡lisis dinÃ¡mico -->
            </div>
        </section>

        <!-- Tendencias Section -->
        <section id="tendenciasSection" class="section" style="display: none;">
            <h2 class="section-title">ğŸ“ˆ Tendencias Temporales</h2>
            <div id="tendenciasContainer" class="tendencias-container">
                <!-- Tendencias dinÃ¡micas -->
            </div>
        </section>

        <!-- Empty State -->
        <div id="emptyState" class="empty-state" style="display: none;">
            <div class="empty-icon">ğŸ“Š</div>
            <h3>No hay datos suficientes para anÃ¡lisis</h3>
            <p>Registra algunas incidencias para obtener recomendaciones inteligentes</p>
            <a href="/incidencias" class="btn-primary">Registrar Incidencia</a>
        </div>

    </main>

    <script src="/static/js/recomendaciones.js"></script>

    <script>
        // ProtecciÃ³n de ruta
        if (!localStorage.getItem("token")) {
            window.location.href = "/login";
        }

        function logout() {
            if (confirm("Â¿EstÃ¡s seguro de que deseas cerrar sesiÃ³n?")) {
                localStorage.removeItem("token");
                window.location.href = "/login";
            }
        }

        function reloadData() {
            location.reload();
        }
    </script>

</body>
</html>